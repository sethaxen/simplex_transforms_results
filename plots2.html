<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplex transforms results</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <script src="scripts/sidebar.js"></script>
    <script src="scripts/plots.js"></script>

    <div class="menu-bar">
        <div>
            <a href="index.html">Home</a>
            <a href="plots2.html">Plots2</a>
        </div>
        <div class="hamburger" onclick="toggleSidebar()">â˜°</div>
    </div>

    <div class="sidebar" id="sidebar">
        <h3>Options</h3>
        <div class="selector">
            <label for="columnSelect">Metric:</label>
            <select id="columnSelect">
                <option value="max_abs_rel_error">max_abs_rel_error</option>
                <option value="min_rel_ess_per_chain">min_rel_ess_per_chain</option>
                <option value="min_rel_ess_bulk">min_rel_ess_bulk</option>
                <option value="max_rhat">max_rhat</option>
                <option value="n_divergent">n_divergent</option>
                <option value="bfmi">bfmi</option>
            </select>
        </div>
        <div class="selector">
            <label for="logScaleSelect">Log-simplex:</label>
            <input type="checkbox" id="logScaleSelect" checked>
        </div>
        <div class="selector">
            <label for="estimateSelect">Estimate:</label>
            <select id="estimateSelect">
                <option value="x_mean" selected>x_mean</option>
                <option value="x2_mean">x2_mean</option>
                <option value="entropy">entropy</option>
            </select>
        </div>
        <!-- Add slider for band probability -->
        <div class="selector">
            <label for="bandProbability">Band probability:</label>
            <input type="range" id="bandProbability" min="0" max="1" step="0.01" value="0.8">
            <output for="bandProbability" id="bandProbabilityOutput"></output>
            <script>
                function updateProbabilityOutput() {
                    document.getElementById('bandProbabilityOutput').value = document.getElementById('bandProbability').value;
                }
                document.getElementById('bandProbability').addEventListener('input', updateProbabilityOutput);
                updateProbabilityOutput();
            </script>
        </div>
    </div>
    <div class="content">
        <h1>Simplex transforms results</h1>
        <div id="columnInfo" class="callout"></div>
        <div id="plot-container">
            <div id="plot"></div>
        </div>
    </div>
    <script>
        d3.csv("results/summaries/all.csv").then(data => {
            function updatePlots() {
                const selectedColumn = document.getElementById('columnSelect').value;
                const selectedEstimate = document.getElementById('estimateSelect').value;
                const logScale = document.getElementById('logScaleSelect').checked;
                const bandProbability = parseFloat(document.getElementById('bandProbability').value);
                const filteredData = data.filter(row => (row.log_scale === 'True') === logScale && row.estimate === selectedEstimate);
                plotSummary2(filteredData, selectedColumn, bandProbability);
            }

            document.getElementById('columnSelect').addEventListener('change', updatePlots);
            document.getElementById('logScaleSelect').addEventListener('change', updatePlots);
            document.getElementById('estimateSelect').addEventListener('change', updatePlots);
            document.getElementById('bandProbability').addEventListener('input', updatePlots);

            // Initial plot
            updatePlots();

            // Update plot on window resize to handle mobile view
            window.addEventListener('resize', updatePlots);
        }).catch(error => {
            console.error('Error loading or parsing data:', error);
        });
    </script>
</body>
</html>
